openapi: 3.0.0
info:
  version: '2.0.0'
  title: 'incadea APIs - Service Package'
  description: 'Encloses the APIs related to the Service (After Sales) area'
tags:
  - name: Service

paths: 
  /api/service/companies/{CompanyName}/orders:      
    get:
      summary: "Get the list of the service orders based on the search and filter criteria."
      description: "This API supports the pagination"     
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.1.0#/components/parameters/PaginationLimit"     
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.1.0#/components/parameters/PaginationOffset"          
        - name: DateFrom
          description: "A start date of the expected period of the appointment date."
          in: "query"
          required: false
          schema:
            type: string
            format: datetime
            example: "2019-06-10T08:00:00+0200"        
        - name: DateTo
          description: "An end date of the expected period of the appointment date"
          in: "query"
          required: false
          schema:
            type: string
            format: datetime
            example: "2019-06-10T20:00:00+0200"
        - name: ServiceAdvisorId
          description: "The unique identifier of the service advisor to whom the orders are assigned."
          in: "query"
          required: false
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"
      responses:
        200:
          description: "A collection of the service orders"
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"
            Content-Range:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.1.0#/components/headers/ContentRange"                
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Order"
        400:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ClientError"
        500:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ServerError"            
 
  /api/service/companies/{CompanyName}/orders/{OrderId}:   
    get:
      summary: "Get the detailed information about the service order by its identifier"
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - name: OrderId
          description: "The unique identifier of the service order."
          in: path
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"           
      responses:
        200:
          description: "A detailed information about the service order"
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderDetails"
        400:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ClientError"
        500:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ServerError"  
    
  /api/service/companies/{CompanyName}/openjobs:      
    get:
      summary: "Get the list of the open jobs based on the search and filter criteria."
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - name: VehicleId
          description: "An unique identifier of the Vehicle"
          in: "query"
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"
      responses:
        200:
          description: "A collection of the open jobs related to the given vehicle"
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OpenJob"
        400:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ClientError"
        500:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ServerError"
          
  /api/service/companies/{CompanyName}/openjobs/{JobId}/convert:
    post:
      summary: "Move the open job to the scope of the provided service order"
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - name: OrderId
          description: "The unique identifier of the service order."
          in: query
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"   
        - name: JobId
          description: "The unique identifier of the open job."
          in: path
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"               
      responses:
        "204":
          description: ""
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"    

  /api/service/companies/{CompanyName}/orders/{OrderId}/documents/confirmation:   
    get:
      summary: "Get the Service Order Confirmation related to this Service Order. In case the document has not been signed yet, a preview will be returned."
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - name: OrderId
          description: "The unique identifier of the service order."
          in: path
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"    
        - name: Type
          description: "The type of the report."
          in: query
          required: true
          schema:
            type: string
            enum: [Draft, Signed]
            example: "Draft"             
      responses:
        200:
          description: "A report as pdf"
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"
          content:
            application/pdf:
                schema:
                  type: string
                  format: binary
        400:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ClientError"
        500:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ServerError"  

    post:
      summary: "Save the Service Order Confirmation document in the backend system"
      tags:
        - Service
      parameters:
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/Authorization"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/AcceptLanguage"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/CompanyName"
        - $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/parameters/LocationIdMandatory"  
        - name: OrderId
          description: "The unique identifier of the service order."
          in: path
          required: true
          schema:
            type: string
            example: "3056bedb-5962-4de5-9bbb-641be0300034"      
        - name: Type
          description: "The type of the report."
          in: query
          required: true
          schema:
            type: string
            enum: [Draft, Signed]
            example: "Draft"                    
      requestBody:
        description: "The document as pdf"
        content:
          application/json:
            schema:
              description: "Base64-encoded contents of the pdf file"
              type: string
              format: byte
          application/pdf:
              schema:
                type: string
                format: binary              
              
      responses:
        204:
          description: "The document has been successfully stored"
          headers:
            Content-Language:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/headers/ContentLanguage"
        400:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ClientError"
        500:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/responses/ServerError" 
          
components:
  schemas:
    Order:
      description: "A service order"
      type: object
      required:
        - Id
        - DocumentNo
        - LocationId
        - AppointmentDate 
      properties:
        Id:
          description: "The unique identifier of the service order"
          type: string
          example: "3056bedb-5962-4de5-9bbb-641be0300034"
        DocumentNo:
          description: "The internal identifier (document number) of the service order"
          type: string
          example: "SO110567"    
        AppointmentDate:
          description: "The appointment date"
          type: string
          format: datetime
          example: "2019-06-10T20:00:00+0200"
        LocationId:
          type: string
          description: "The unique identifier of the location, where the service order belongs to"
          example: "c5139877-1763-4680-a998-490bd97d4270"
        ServiceAdvisorId:
          description: "The unique identifier of the Service Advisor"
          type: string
          example: "3056bedb-5962-4de5-9bbb-641be0300034"
        Vehicle:
          type: object
          required:
            - Id
            - LicenseNo
          properties:
            Id:
              description: "An unique identifier of the Vehicle"
              type: string
              example: "c5139877-1763-4680-a998-490bd97d4270"
            VIN:
              description: "An unique identifier of the Vehicle"
              type: string
              maxLength: 17
              example: "WBAP71000SB123101"
            VIN2:
              description: "An additional identifier of the vehicle, e.g. fabrication code"
              type: string
              maxLength: 17
              example: "WBAP71000SB123101"  
            LicenseNo:
              description: "The license number of the Vehicle"
              type: string
              example: "M2000AB"
            Make:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/Make"
            Model:
              description: "The model of the vehicle"
              type: string
        Customer:
          type: object
          required:
            - Name
          properties:
            Name:
              description: "The name of the customer"
              type: string
            Phone:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/PhoneNumber"
            Email:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/EMail"
            
    OrderDetails:
      description: "A detailed service order"
      type: object
      required:
        - Id
        - DocumentNo
        - LocationId
        - AppointmentDate 
      properties:
        Id:
          description: "The unique identifier of the order"
          type: string
          example: "3056bedb-5962-4de5-9bbb-641be0300034"
        DocumentNo:
          description: "The internal identifier of the order"
          type: string
          example: "SO110567"    
        LocationId:
          type: string
          description: "The unique identifier of the location, where the service order belongs to"
          example: "c5139877-1763-4680-a998-490bd97d4270"
        AppointmentDate:
          description: "The appointment date"
          type: string
          format: datetime
          example: "2019-06-10T20:00:00+0200"
        ServiceAdvisor:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.1.0#/components/schemas/User"
        PickupDate:
          description: "The date when the vehicle is to be picked up from the workshop"
          type: string
          format: datetime
          example: "2019-06-10T20:00:00+0200"
        PickupServiceAdvisor:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.1.0#/components/schemas/User" 
        ServiceJobs:
          type: array
          items:
              $ref: "#/components/schemas/ServiceJob"
        ServiceLines:
          type: array
          items:
            $ref: "#/components/schemas/ServiceLine"
        Vehicle:
          type: object
          required:
            - Id
            - LicenseNo
          properties:
            Id:
              description: "An unique identifier of the Vehicle"
              type: string
              example: "c5139877-1763-4680-a998-490bd97d4270"
            VIN:
              description: "An unique identifier of the Vehicle"
              type: string
              maxLength: 17
              example: "WBAP71000SB123101"
            VIN2:
              description: "An additional identifier of the vehicle, e.g. fabrication code"
              type: string
              maxLength: 17
              example: "WBAP71000SB123101"  
            LicenseNo:
              description: "The license number of the Vehicle"
              type: string
              example: "M2000AB"
            Make:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/Make"
            Model:
              description: "The model of the vehicle"
              type: string
            ModelYear:
              description: "The model year of the vehicle"
              type: integer
              example: 2012
            Color:
              description: "The color the vehicle"
              type: string
            Mileage:
              description: "The mileage the vehicle"
              type: integer
              example: 9910  
            InitialRegistrationDate:
              description: "The initial registration date"
              type: string
              format: datetime
              example: "2012-06-10T00:00:00+0200"      
            NextGeneralInspectionDate:
              description: "The next general inspection date"
              type: string
              format: datetime
              example: "2020-02-10T00:00:00+0200"              
            LastVisitDate:
              description: "The date of the last visit date"
              type: string
              format: datetime
              example: "2019-01-09T10:00:00+0200"                  
        Customer:
          type: object
          required:
            - Name
          properties:
            Name:
              type: string
            Address:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/Address"
            Phone:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/PhoneNumber"
            Email:
              $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/EMail"

    OpenJob:
      description: "Describing the open job"
      type: object
      required:
        - Id
        - Description 
      properties:
        Id:
          description: "An unique identifier of the open job"
          type: string
          example: "3056bedb-5962-4de5-0001-641be0300034"  
        Description:
          description: "The description of the open job/service to be done."
          type: string
          example: "Oil change"
        DueDate:
          description: "An estimated date, by when this job has to be performed"
          type: string
          format: datetime
          example: "2020-10-09T10:00:00+0200" 
        CreatedOn:
          description: "A date, when this job has been captured/created in the backend system"
          type: string
          format: datetime
          example: "2019-10-09T10:00:00+0200"         
        Type:
          description: "The type of job to be performed"
          type: string
          example: "technical"    
        Mileage:
          description: "The mileage the vehicle"
          type: integer
          example: 9910     
        OrderNo:
          description: "The internal document number of the related service order, from where this open job has come"
          type: string
          example: "SO0002352"              
        ChecklistNo:
          description: "The internal number of the vehicle checklist related to this open job to be created"
          type: string
          example: "SPR2020"           

    ServiceJob:
      description: "A summary description of the Service Job"
      type: object
      required:
        - Id
        - Description 
      properties:
        Id:
          description: "An unique identifier of the service job"
          type: string
          example: "3056bedb-5962-4de5-0001-641be0300034"  
        Description:
          description: "The description of the service job"
          type: string
          example: "Oil change"
        DescriptionLong:
          description: "The additional description of the service job"
          type: string  
        Price:
          $ref: "https://api.swaggerhub.com/domains/incadea/Generic/2.0.0#/components/schemas/Price"            
        BillToCustomerName:
          description: "The name of the customer, who will be billed for this service job"
          type: string
          example: "John Smith"

    ServiceLine:
      type: object
      required:
        - No
        - Description
      properties:
        JobId:
          description: "The unique identifier of the service job, where this service line belongs to"
          type: string
          example: "3056bedb-5962-4de5-0001-641be0300034"
        Type:
          description: "The type"
          type: string
        No:
          description: "The number"
          type: string
        Description:
          description: "The description"
          type: string
        Quantity:
          description: "The quantity"
          type: number
          format: decimal
          example: 1.5
        UnitOfMeasure:
          description: "The unit of the measure"
          type: string
          example: "h"

servers:
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/incadea/Service/2.0.0
