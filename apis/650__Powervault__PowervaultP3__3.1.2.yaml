penapi: "3.0.1"
info:
  title: "Powervault P3 API"
  version: "3.1.2"
servers:
- url: "https://api.p3.powervault.co.uk/v3"
tags:
  - name: customerAccount
    description: Powervault customer account
  - name: group
    description: Group of Powervault P3 units
  - name: unit
    description: Powervault P3 units
paths:
  /customerAccount:
    get:
      tags:
        - customerAccount
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetCustomerAccountsResponse"
      security:
      - api_key: []
  /group:
    get:
      tags:
        - group
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetGroupsResponse"
      security:
      - api_key: []
  /group/{groupId}:
    get:
      tags:
        - group
      parameters:
      - name: "groupId"
        in: "path"
        required: true
        schema:
          type: "integer"
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetGroupResponse"
      security:
      - api_key: []
  /unit:
    get:
      tags:
        - unit
      parameters:
      - name: "customerAccountId"
        in: "query"
        required: true
        schema:
          type: "integer"
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUnitsResponse"
      security:
      - api_key: []
  /unit/{unitId}:
    get:
      tags:
        - unit
      parameters:
      - name: "unitId"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUnitResponse"
      security:
      - api_key: []
  /unit/{unitId}/data:
    get:
      tags:
        - unit
      parameters:
      - name: "unitId"
        in: "path"
        required: true
        schema:
          type: "string"
      - name: "period"
        in: "query"
        required: false
        schema:
          type: "string"
          enum: ["today", "yesterday", "past-hour", "last-hour", "past-day", "last-day", "past-week", "last-week", "past-month", "last-month"]
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUnitDataResponse"
      security:
      - api_key: []
  /unit/{unitId}/schedule:
    get:
      tags:
        - unit
      parameters:
      - name: "unitId"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUnitScheduleResponse"
      security:
      - api_key: []
    post:
      tags:
        - unit
      parameters:
      - name: "unitId"
        in: "path"
        required: true
        schema:
          type: "string"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostUnitScheduleRequest'
      responses:
        200:
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PostUnitScheduleResponse"
      security:
      - api_key: []
components:
  schemas:
    GetCustomerAccountsResponse:
      title: "Get Customer Account Response"
      type: "object"
      properties:
        customerAccounts:
          type: "object"
          properties:
            id:
              type: "integer"
            accountName:
              type: "string"
    GetGroupsResponse:
      title: "Get Groups Response"
      type: "object"
      properties:
        groups:
          type: "array"
          items:
            type: "object"
            properties:
              id:
                type: "integer"
              groupName:
                type: "string"
    GetGroupResponse:
      title: "Get Group Response"
      type: "object"
      properties:
        units:
          type: "array"
          items:
            type: "object"
            properties:
              id:
                type: "integer"
    GetUnitsResponse:
      title: "Get Units Response"
      type: "object"
      properties:
        units:
          type: "array"
          items:
            type: "object"
            properties:
              unitId:
                type: "string"
              contractId:
                type: "string"
    GetUnitResponse:
      title: "Get Unit Response"
      type: "object"
      properties:
        unit:
          type: "object"
          properties:
            id:
              type: "integer"
            date:
              type: "string"
            model:
              type: "string"
    GetUnitDataResponse:
      title: "Get Unit Data Response"
      type: "object"
      properties:
        data:
          type: "array"
          items:
            type: "object"
            properties:
              time:
                    type: "string"
              batteryInputFromGrid:
                    type: "number"
              batteryInputFromSolar:
                    type: "number"
              batteryOutputConsumedByHome:
                    type: "number"
              batteryOutputExported:
                    type: "number"
              homeConsumed:
                    type: "number"
              gridConsumedByHome:
                    type: "number"
              solarConsumedByHome:
                    type: "number"
              solarExported:
                    type: "number"
              instant_battery:
                    type: "number"
              instant_demand:
                    type: "number"
              instant_grid:
                    type: "number"
              solarGenerated:
                    type: "number"
              solarConsumption:
                    type: "number"
              instant_solar:
                    type: "number"
              instant_soc:
                    type: "number"
    GetUnitScheduleResponse:
      title: "Get Unit Schedule Response"
      type: "object"
      properties:
        meta:
          type: "object"
          properties:
            dateModified:
                  type: "string"
            source:
                  type: "string"
        schedule:
          type: "object"
          properties:
            monday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            tuesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            wednesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            thursday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            friday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            saturday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            sunday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
    PostUnitScheduleRequest:
      title: "Post Unit Schedule Request"
      type: "object"
      properties:
        schedule:
          type: "object"
          properties:
            monday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            tuesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            wednesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            thursday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            friday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            saturday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            sunday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
    PostUnitScheduleResponse:
      title: "Post Unit Schedule Response"
      type: "object"
      properties:
        message:
          type: "string"
        schedule:
          type: "object"
          properties:
            monday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            tuesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            wednesday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            thursday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            friday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            saturday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
            sunday:
              type: "array"
              items:
                type: "object"
                properties:
                  start:
                    type: "string"
                  end:
                    type: "string"
                  state:
                    type: "string"
  securitySchemes:
    api_key:
      type: "apiKey"
      name: "x-api-key"
      in: "header"