penapi: 3.0.0
servers:
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/embetec/STABIL/1.0.0
info:
  description: Dies ist eine erste API Beschreibung der JOSY API zum Abrufen und speichern von Auswertungen.
  version: "1.0.0"
  title: JOSY - Auswertungen
  contact:
    email: info@embeteco.de
tags:
  - name: josy-app
    description: Aufrufe, welche ausschließlich von der App ausgeführt werden.
  - name: extern
    description: offene API für weitere Anwendungen.
paths:
  /item:
    get:
      tags:
        - extern
        - josy-app
      summary: abrufen der Auswertungen
      operationId: searchItems
      description: |
        Alle Auswertungen aller Nutzer aus allen JOSY Apps
      #parameters:
      #  - in: query
      #    name: searchString
      #    description: pass an optional search string for looking up inventory
      #    required: false
      #    schema:
      #      type: string
      #  - in: query
      #    name: skip
      #    description: number of records to skip for pagination
      #    schema:
      #      type: integer
      #      format: int32
      #      minimum: 0
      #  - in: query
      #    name: limit
      #    description: maximum number of records to return
      #    schema:
      #      type: integer
      #      format: int32
      #      minimum: 0
      #      maximum: 50
      responses:
        '200':
          description: Ergebnis mit passenden Auswertungen.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Survey'
    post:
      tags:
        - josy-app
      summary: fügt eine Auswertung ins System hinzu
      operationId: addItem
      description: Fügt eine Auswertung ins System hinzu oder erweiterte eine zuvor gespeicherten Survey mit gleichen keys und timestamp.
      responses:
        '201':
          description: Auswertung hinzugefügt
        '401': 
          description: 'user not authorized'
        '406':
          description: 'One or more input values are missing!'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FinishedSurvey'
        description: Inventory item to add
        
  /question:
    get:
      summary: abrufen der Fragen
      operationId: searchQuestions
      description: |
        Alle Fragen der Josy App
      tags: 
        - extern
      responses:
        '200':
          description: Ergebnis mit allen Fragen
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Question'
                  
  /competence:
    get:
      summary: abrufen der Kompetenzen
      operationId: searchCompetencies
      description: |
        Abrufen aller Kompetenzen
      tags: 
        - extern
      responses:
        '200':
          description: Ergebnis mit allen Kompetenzen
          content:
            application/json: 
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Competence'
        
components:
  schemas:
    FinishedSurvey:
      required:
        - code
        - userId
        - date
        - userType
        - surveyType
      properties:
        code:
          type: string
          description: API Key welcher der App zugeordnet wurde.
        userId: 
          type: string
          format: numerisch
          description: Nutzerid des zugehörigen Nutzers.
          example: '2007'
        date: 
          type: string
          format: 'Y-m-d H:i:s'
          description: Erstellungsdatum der Auswertung.
          example: '2009-12-24 23:42:1'
        userType: 
          type: string
          description: Nutzer einer jeweiligen Auswertung.
          example: 'Teilnehmer'
        surveyType: 
          type: string
          description: Abfragetyp der jeweiligen Auswertung
          example: 'assessment'
        duration: 
          type: string
          format: 'Y-m-d H:i:s'
          description: Dauer der jeweiligen Auswertung.
          example: '2009-12-24 23:42:1'
        positive_answers:
          type: array
          items:
            type: number
          description: Sammlung aller positiv beantworteter Fragen mit identifizierung per ID
          example: [1150, 679]
        neutral_answers:
          type: array
          items:
            type: number
          description: Sammlung aller neutral beantworteter Fragen mit identifizierung per ID
          example: [808, 70]
        negative_answers:
          type: array
          items:
            type: number
          description: Sammlung aller negativ beantworteter Fragen mit identifizierung per ID
          example: [847, 187]
      type: object 
      
    Survey:
      type: object
      required: 
        - id
        - user
      properties:
        id:
          type: number
          example: 6200
        user:
          type: string
          description: Nutzer einer jeweiligen Auswertung.
          example: 'Teilnehmer'
        positive_answers:
          type: array
          items:
            type: number
          description: Sammlung aller positiv beantworteter Fragen mit identifizierung per ID
          example: [1150, 679]
        neutral_answers:
          type: array
          items:
            type: number
          description: Sammlung aller neutral beantworteter Fragen mit identifizierung per ID
          example: [808, 70]
        negative_answers:
          type: array
          items:
            type: number
          description: Sammlung aller negativ beantworteter Fragen mit identifizierung per ID
          example: [847, 187]
          
    Question: 
      type: object
      required:
        - id
      
      properties:
        id:
          type: number
          example: 2000
        surveyType: 
          type: string
          description: Abfragetyp der jeweiligen Auswertung
          example: 'assessment'
        content: 
          type: string
          format: HTML
          example: "<p>Ich überlege genau, <br>wofür ich mein Geld ausgebe.</p>"
        comp_plus:
          type: object
          properties: 
            positive_answers: 
              type: array
              items:
                type: number
                format: Kompetenzen ID
                description: Sammlung aller Kompetenzen, welche bei positiver Antwort verstärkt werden.
            negative_answers: 
              type: array
              items:
                type: number
                format: Kompetenzen ID
                description: Sammlung aller Kompetenzen, welche bei negativer Antwort verstärkt werden.
        comp_minus:
          type: object
          properties: 
            positive_answers: 
              type: array
              items:
                type: number
                format: Kompetenzen ID
                description: Sammlung aller Kompetenzen, welche bei positiver Antwort verringert werden.
            negative_answers: 
              type: array
              items:
                type: number
                format: Kompetenzen ID
                description: Sammlung aller Kompetenzen, welche bei negativer Antwort verringert werden.
    Competence: 
      type: object
      
      required:
        - id
        - name
      
      properties:
        id:
          type: number
          example: 2000
        name:
          type: string
          description: Kompetenzenname und identifier bei surveys
          example: 'assessment'