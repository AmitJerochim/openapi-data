openapi: 3.0.1
info:
  title: Unicom Subscription API
  description: |

    ## REST API

    ### Формат ответов

    Все ответы имеют структуру объекта

    ```json
    {
        data: {},   
        error: {}
    }
    ```

    При успешном запросе, в data содержится объект или список объектов.

    При ошибке запроса, в error содержится объект кодом ошибки и сообщением.

    ### Ошибки

    |http статус|код |сообщение                                   |
    |-----------|----|--------------------------------------------|
    |500        |    |Внутренняя ошибка сервера                   |
    |400        |    |Неверный запрос                             |
    |404        |    |Объект не найден                            |
    |502        |    |Ошибка внешнего сервиса                     |
  version: "1.0"
servers:
  - url: unicom24.ru
    description: production server
  - url: develop-38.vuaro.ru
    description: develop server (not available for public)
paths:
  /api/healthcheck:
    get:
      tags:
        - healthcheck
      summary: Состояние сервиса
      responses:
        '200':
          description: Service alive
          content: {}
  /api/tariffs:
    get:
      tags:
        - tariff
      summary: Список тарифов
      parameters:
        - name: limit
          in: query
          schema:
            maximum: 300
            minimum: 0
            type: integer
            format: int32
        - name: valid_days
          in: query
          description: Действителен дней
          schema:
            minimum: 1
            type: integer
            format: int32
        - name: sorting_number
          in: query
          description: Порядок сортировки
          schema:
            type: integer
            format: int32
        - name: is_active
          in: query
          description: Активный
          schema:
            type: boolean
        - name: cost
          in: query
          description: Стоимость
          schema:
            minimum: 0
            type: number
        - name: name
          in: query
          description: Название
          schema:
            type: string
        - name: offset
          in: query
          schema:
            minimum: 0
            type: integer
            format: int32
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TariffList'
    post:
      tags:
        - tariff
      summary: Содание тарифа
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Tariff'
        required: false
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
      x-codegen-request-body-name: body
  '/api/tariffs/{id}':
    get:
      tags:
        - tariff
      summary: Данные тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
    delete:
      tags:
        - tariff
      summary: Удаление тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
    patch:
      tags:
        - tariff
      summary: Изменение тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Tariff1'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
  /api/services:
    get:
      tags:
        - service
      summary: Список услуг
      parameters:
        - name: limit
          in: query
          schema:
            maximum: 300
            minimum: 0
            type: integer
            format: int32
        - name: service_type
          in: query
          description: Тип услуги
          schema:
            type: string
            enum:
              - invariable
              - periodical
        - name: codename
          in: query
          description: Кодовое имя
          schema:
            type: string
        - name: name
          in: query
          description: Название
          schema:
            type: string
        - name: offset
          in: query
          schema:
            minimum: 0
            type: integer
            format: int32
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceList'
    post:
      tags:
        - service
      summary: Содание услуги
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Service'
        required: false
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Service'
      x-codegen-request-body-name: body
  '/api/services/{id}':
    get:
      tags:
        - service
      summary: Данные услуги
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Service'
    delete:
      tags:
        - service
      summary: Удаление услуги
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
    patch:
      tags:
        - service
      summary: Изменение услуги
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Service1'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
  /api/tariff_services:
    get:
      tags:
        - tariff_service
      summary: Список услуг тарифа
      parameters:
        - name: service_id
          in: query
          description: Id услуги
          schema:
            type: integer
            format: int32
        - name: limit
          in: query
          schema:
            maximum: 300
            minimum: 0
            type: integer
            format: int32
        - name: periodic_days
          in: query
          description: Периодичность дней
          schema:
            minimum: 1
            type: integer
            format: int32
        - name: tariff_id
          in: query
          description: Id тарифа
          schema:
            type: integer
            format: int32
        - name: offset
          in: query
          schema:
            minimum: 0
            type: integer
            format: int32
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TariffServiceList'
    post:
      tags:
        - tariff_service
      summary: Содание услуги тарифа
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/TariffService'
        required: false
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TariffService'
      x-codegen-request-body-name: body
  '/api/tariff_services/{id}':
    get:
      tags:
        - tariff_service
      summary: Данные услуги тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TariffService'
    delete:
      tags:
        - tariff_service
      summary: Удаление услуги тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
    patch:
      tags:
        - tariff_service
      summary: Изменение услуги тарифа
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/TariffService1'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
  /api/subscriptions:
    get:
      tags:
        - subscription
      summary: Список подписок
      parameters:
        - name: sms_notification
          in: query
          description: Оповещать через sms
          schema:
            type: boolean
        - name: auto_prolongation
          in: query
          description: Продлевать автоматически
          schema:
            type: boolean
        - name: is_active
          in: query
          description: Активна
          schema:
            type: boolean
        - name: limit
          in: query
          schema:
            maximum: 300
            minimum: 0
            type: integer
            format: int32
        - name: payment_type
          in: query
          description: Тип платежа
          schema:
            type: string
        - name: start_date
          in: query
          description: Дата начала
          schema:
            type: string
            format: date-time
        - name: email_notification
          in: query
          description: Оповещать по email
          schema:
            type: boolean
        - name: next_payment_date
          in: query
          description: Дата следующего  платежа
          schema:
            type: string
            format: date-time
        - name: id
          in: query
          schema:
            type: integer
            format: int32
        - name: user_id
          in: query
          description: Id пользователя
          schema:
            type: integer
            format: int32
        - name: tariff_id
          in: query
          description: Id тарифа
          schema:
            type: integer
            format: int32
        - name: end_date
          in: query
          description: Дата окончания
          schema:
            type: string
            format: date-time
        - name: offset
          in: query
          schema:
            minimum: 0
            type: integer
            format: int32
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionList'
    post:
      tags:
        - subscription
      summary: Содание подписки
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Subscription'
        required: false
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscription'
      x-codegen-request-body-name: body
  '/api/subscriptions/{id}':
    get:
      tags:
        - subscription
      summary: Данные подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscription'
    delete:
      tags:
        - subscription
      summary: Удаление подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
    patch:
      tags:
        - subscription
      summary: Изменение подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Subscription1'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
  '/api/subscriptions/{id}/activate':
    post:
      tags:
        - subscription
      summary: Активация подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/SubscriptionActivate'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
  /api/notifications:
    get:
      tags:
        - notification
      summary: Список оповещений подписки
      parameters:
        - name: offset
          in: query
          schema:
            minimum: 0
            type: integer
            format: int32
        - name: service_id
          in: query
          description: Id услуги
          schema:
            type: integer
            format: int32
        - name: limit
          in: query
          schema:
            maximum: 300
            minimum: 0
            type: integer
            format: int32
        - name: scheduled_time
          in: query
          description: Плановое время выполнения
          schema:
            type: string
            format: date-time
        - name: completion_time
          in: query
          description: Фактическое время выполнения
          schema:
            type: string
            format: date-time
        - name: subscription_id
          in: query
          description: Id подписки
          schema:
            type: integer
            format: int32
        - name: status
          in: query
          description: Статус
          schema:
            type: string
            enum:
              - created
              - done
              - error
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationList'
    post:
      tags:
        - notification
      summary: Содание оповещения подписки
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Notification'
        required: false
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
      x-codegen-request-body-name: body
  '/api/notifications/{id}':
    get:
      tags:
        - notification
      summary: Данные оповещения подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
    delete:
      tags:
        - notification
      summary: Удаление оповещения подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
    patch:
      tags:
        - notification
      summary: Изменение оповещения подписки
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Notification1'
        required: false
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
      x-codegen-request-body-name: body
components:
  schemas:
    Tariff:
      required:
        - cost
        - description
        - name
        - sorting_number
        - valid_days
      type: object
      properties:
        description:
          type: string
          description: Описание
        cost:
          minimum: 0
          type: number
          description: Стоимость
        created:
          type: string
          description: Дата создания
          format: date-time
          readOnly: true
        sorting_number:
          type: integer
          description: Порядок сортировки
          format: int32
        is_active:
          type: boolean
          description: Активный
          default: true
        id:
          type: integer
          format: int32
          readOnly: true
        name:
          type: string
          description: Название
        valid_days:
          minimum: 1
          type: integer
          description: Действителен дней
          format: int32
    TariffList:
      type: object
      properties:
        count:
          type: integer
          format: int32
          readOnly: true
        limit:
          maximum: 300
          minimum: 0
          type: integer
          format: int32
        results:
          type: array
          items:
            $ref: '#/components/schemas/Tariff'
        offset:
          minimum: 0
          type: integer
          format: int32
    EmptyResponse:
      type: object
    Tariff1:
      type: object
      properties:
        description:
          type: string
          description: Описание
        cost:
          minimum: 0
          type: number
          description: Стоимость
        created:
          type: string
          description: Дата создания
          format: date-time
          readOnly: true
        sorting_number:
          type: integer
          description: Порядок сортировки
          format: int32
        is_active:
          type: boolean
          description: Активный
          default: true
        id:
          type: integer
          format: int32
          readOnly: true
        name:
          type: string
          description: Название
        valid_days:
          minimum: 1
          type: integer
          description: Действителен дней
          format: int32
    Service:
      required:
        - service_type
      type: object
      properties:
        description:
          type: string
          description: Описание
        service_type:
          type: string
          description: Тип услуги
          enum:
            - invariable
            - periodical
        codename:
          type: string
          description: Кодовое имя
        id:
          type: integer
          format: int32
          readOnly: true
        name:
          type: string
          description: Название
    ServiceList:
      type: object
      properties:
        count:
          type: integer
          format: int32
          readOnly: true
        limit:
          maximum: 300
          minimum: 0
          type: integer
          format: int32
        results:
          type: array
          items:
            $ref: '#/components/schemas/Service'
        offset:
          minimum: 0
          type: integer
          format: int32
    Service1:
      type: object
      properties:
        description:
          type: string
          description: Описание
        service_type:
          type: string
          description: Тип услуги
          enum:
            - invariable
            - periodical
        codename:
          type: string
          description: Кодовое имя
        id:
          type: integer
          format: int32
          readOnly: true
        name:
          type: string
          description: Название
    TariffService:
      required:
        - periodic_days
        - service_id
        - tariff_id
      type: object
      properties:
        id:
          type: integer
          format: int32
          readOnly: true
        service_id:
          type: integer
          description: Id услуги
          format: int32
        periodic_days:
          minimum: 1
          type: integer
          description: Периодичность дней
          format: int32
        tariff_id:
          type: integer
          description: Id тарифа
          format: int32
    TariffServiceList:
      type: object
      properties:
        count:
          type: integer
          format: int32
          readOnly: true
        limit:
          maximum: 300
          minimum: 0
          type: integer
          format: int32
        results:
          type: array
          items:
            $ref: '#/components/schemas/TariffService'
        offset:
          minimum: 0
          type: integer
          format: int32
    TariffService1:
      type: object
      properties:
        id:
          type: integer
          format: int32
          readOnly: true
        service_id:
          type: integer
          description: Id услуги
          format: int32
        periodic_days:
          minimum: 1
          type: integer
          description: Периодичность дней
          format: int32
        tariff_id:
          type: integer
          description: Id тарифа
          format: int32
    Subscription:
      required:
        - tariff_id
        - user_id
      type: object
      properties:
        sms_notification:
          type: boolean
          description: Оповещать через sms
          default: false
        auto_prolongation:
          type: boolean
          description: Продлевать автоматически
          default: false
        is_active:
          type: boolean
          description: Активна
          default: false
        payment_type:
          type: string
          description: Тип платежа
        start_date:
          type: string
          description: Дата начала
          format: date-time
        email_notification:
          type: boolean
          description: Оповещать по email
          default: false
        next_payment_date:
          type: string
          description: Дата следующего  платежа
          format: date-time
        id:
          type: integer
          format: int32
        user_id:
          type: integer
          description: Id пользователя
          format: int32
        tariff_id:
          type: integer
          description: Id тарифа
          format: int32
        end_date:
          type: string
          description: Дата окончания
          format: date-time
    SubscriptionList:
      type: object
      properties:
        count:
          type: integer
          format: int32
          readOnly: true
        limit:
          maximum: 300
          minimum: 0
          type: integer
          format: int32
        results:
          type: array
          items:
            $ref: '#/components/schemas/Subscription'
        offset:
          minimum: 0
          type: integer
          format: int32
    Subscription1:
      type: object
      properties:
        sms_notification:
          type: boolean
          description: Оповещать через sms
          default: false
        auto_prolongation:
          type: boolean
          description: Продлевать автоматически
          default: false
        is_active:
          type: boolean
          description: Активна
          default: false
        payment_type:
          type: string
          description: Тип платежа
        start_date:
          type: string
          description: Дата начала
          format: date-time
        email_notification:
          type: boolean
          description: Оповещать по email
          default: false
        next_payment_date:
          type: string
          description: Дата следующего  платежа
          format: date-time
        id:
          type: integer
          format: int32
        user_id:
          type: integer
          description: Id пользователя
          format: int32
        tariff_id:
          type: integer
          description: Id тарифа
          format: int32
        end_date:
          type: string
          description: Дата окончания
          format: date-time
    SubscriptionActivate:
      required:
        - payment_type
      type: object
      properties:
        payment_type:
          type: string
    Notification:
      required:
        - service_id
        - subscription_id
      type: object
      properties:
        service_id:
          type: integer
          description: Id услуги
          format: int32
        scheduled_time:
          type: string
          description: Плановое время выполнения
          format: date-time
        id:
          type: integer
          format: int32
          readOnly: true
        completion_time:
          type: string
          description: Фактическое время выполнения
          format: date-time
        subscription_id:
          type: integer
          description: Id подписки
          format: int32
        status:
          type: string
          description: Статус
          enum:
            - created
            - done
            - error
    NotificationList:
      type: object
      properties:
        count:
          type: integer
          format: int32
          readOnly: true
        limit:
          maximum: 300
          minimum: 0
          type: integer
          format: int32
        results:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        offset:
          minimum: 0
          type: integer
          format: int32
    Notification1:
      type: object
      properties:
        service_id:
          type: integer
          description: Id услуги
          format: int32
        scheduled_time:
          type: string
          description: Плановое время выполнения
          format: date-time
        id:
          type: integer
          format: int32
          readOnly: true
        completion_time:
          type: string
          description: Фактическое время выполнения
          format: date-time
        subscription_id:
          type: integer
          description: Id подписки
          format: int32
        status:
          type: string
          description: Статус
          enum:
            - created
            - done
            - error