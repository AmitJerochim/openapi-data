{"openapi":"3.0.0","info":{"title":"Polebuddy","description":"A student-centric API for PoleBuddy.","version":"1.4","contact":{"email":"tim.simon@polebuddy.com"}},"paths":{"/students/{student-id}":{"parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}}],"get":{"summary":"Fetch the given student's profile","operationId":"","responses":{"200":{"description":"Student Profile","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/Student"}}}}}}}}},"/students/{student-id}/studios":{"get":{"summary":"Fetch all studios the student is associated with.","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"studio":{"$ref":"#/components/schemas/Studio"},"lastLogin":{"type":"string","format":"date-time"}}}}}}}}}}}},"/students/{student-id}/invoices":{"summary":"Fetch invoices belonging to student","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"studio","in":"query","schema":{"type":"integer"},"required":true,"description":"The studio to filter invoices by."}],"get":{"summary":"fetch all invoices for the given student","description":"","operationId":"getStudentInvoices","responses":{"200":{"description":"Successful Retrevial","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Invoice"}}}}}}}}},"post":{"summary":"Create an invoice","description":"","operationId":"postStudentInvoice","responses":{"200":{"description":"Successfull Invoice Creation.","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"allOf":[{"$ref":"#/components/schemas/Invoice"},{"$ref":"#/components/schemas/PaymentIntent"}]}}}}}}}},"put":{"summary":"Verify a set of line items prior to invoice creation.","description":"Verify a set of line items, prior to invoice creation.","operationId":"putStudentInvoice","responses":{"202":{"description":"Successful draft invoice.","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"invoice":{"$ref":"#/components/schemas/DraftInvoice"},"disclaimers":{"type":"array","items":{"$ref":"#/components/schemas/Disclaimer"}}}}}}}}},"409":{"description":"Invalid parameters in query or in body.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/students/{student-id}/disclaimers":{"summary":"Fetch disclaimers belonging to student","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"studio","in":"query","schema":{"type":"integer"},"required":true,"description":"The studio to filter disclaimers by."}],"get":{"summary":"fetch all disclaimers for the given student","description":"","operationId":"getStudentDisclaimers","responses":{"200":{"description":"Successful Retrevial","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Disclaimer"}}}}}}}}},"post":{"summary":"Acknowledge a disclaimer","description":"","operationId":"postStudentDisclaimer","responses":{"200":{"description":"Successful Retrevial","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/DisclaimerAcknowledgement"}}}}}}}}}},"/students/{student-id}/enrolments":{"summary":"Student-specific enrolment functionality","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"studio","in":"query","required":true,"schema":{"type":"integer"}}],"get":{"summary":"Fetch all enrolments for the given student. ","description":"","operationId":"getStudentEnrolments","parameters":[{"name":"studio","in":"query","schema":{"type":"integer"},"required":true,"description":"The studio to filter enrolments by."}],"responses":{"200":{"description":"Successful Retrevial","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Enrolment"}}}}}}}}}},"/students/{student-id}/enrolments/{enrolment-id}":{"summary":"Student-specific enrolment functionality","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"enrolment-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"studio","in":"query","required":true,"schema":{"type":"integer"}}],"delete":{"summary":"Withdraw from an enrolment","description":"","operationId":"deleteStudentEnrolment","responses":{"default":{"description":"Default error sample response"}}}},"/students/{student-id}/classes":{"summary":"Interact with classes (timeslots) the student has enrolled into. ","parameters":[{"name":"student-id","in":"path","required":true,"schema":{"type":"integer"}}],"get":{"summary":"List all classes the student has enrolled into. ","description":"","operationId":"getStudentClasses","parameters":[{"name":"studio","in":"query","schema":{"type":"integer"},"required":true,"description":"The studio to filter classes by."}],"responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"anyOf":[{"$ref":"#/components/schemas/BlockSlot"},{"$ref":"#/components/schemas/PrivateSlot"},{"$ref":"#/components/schemas/CasualSlot"}]}}}}}}}}},"post":{"summary":"Mark attendance on the given class.","description":"Mark attendence on a given class","requestBody":{"description":"PostClasses::class","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Mark_Attendance_Model"},"example":{"$ref":"#/components/examples/Model_PostClasses_Example"}}}},"operationId":"postStudentClass","responses":{"default":{"description":"Default error sample response"}}}},"/studios/{studio-id}":{"get":{"summary":"Fetch the studio with the given ID.","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/Studio"}}}}}}}}},"/studios/{studio-id}/courses":{"get":{"summary":"Fetches all courses for the given studio.","description":"List courses for the given studio. Courses are listed if: \n - The course is visible to students, and\n - There are upcoming timeblocks scheduled for this course, and\n - The terms the timeblocks are in is visible to students. \n","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Course"}}}}}}}}}},"/studios/{studio-id}/courses/{course-id}":{"get":{"summary":"Fetch one course for studio","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"course-id","in":"path","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/Course"}}}}}}}}},"/studios/{studio-id}/courses/{course-id}/slots":{"summary":"Fetch course slots","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"course-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"type","in":"query","required":false,"schema":{"type":"string","enum":["CASUAL"]}}],"get":{"responses":{"200":{"description":"Successful retrevial","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Slot"}}}}}}}},"/studios/{studio-id}/terms":{"summary":"Fetch all available terms","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}}],"get":{"summary":"Fetch all available terms","description":"","operationId":"getStudioTerms","responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Term"}}}}}}}}}},"/studios/{studio-id}/slots":{"summary":"Fetch all studio slots","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"term","in":"query","required":false,"schema":{"type":"integer"}}],"get":{"summary":"List all enrolments for the studio","description":"","operationId":"getStudioEnrolments","responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Slot"}}}}}}}}}},"/studios/{studio-id}/slots/blocks":{"summary":"Fetch all studio block slots","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"term","in":"query","required":false,"schema":{"type":"integer"}}],"get":{"summary":"List all enrolments for the studio","description":"","operationId":"getStudioBlockEnrolments","responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Slot"}}}}}}}}}},"/studios/{studio-id}/slots/casuals":{"summary":"Fetch all studio casual slots","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}},{"name":"term","in":"query","required":false,"schema":{"type":"integer"}}],"get":{"summary":"List all enrolments for the studio","description":"","operationId":"getStudioCasualEnrolments","responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Slot"}}}}}}}}}},"/studios/{studio-id}/slots/privates":{"summary":"Fetch all studio private slots","parameters":[{"name":"studio-id","in":"path","required":true,"schema":{"type":"integer"}}],"get":{"summary":"List all enrolments for the studio","description":"","operationId":"getStudioPrivateEnrolments","responses":{"200":{"description":"Successful retrieval","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Slot"}}}}}}}}}}},"components":{"schemas":{"Mark_Attendance_Model":{"type":"object","properties":{"attending":{"type":"string","enum":["ATTENDING","NOT_ATTENDING_SICK","NOT_ATTENDING_FAMILY","NOT_ATTENDING_WORK","NOT_ATTENDING_AWAY","NOT_ATTENDING_STUDIO_SCHEDULE_CONFLICT","NOT_ATTENDING_OTHER"]},"course":{"type":"integer","minimum":0},"term":{"type":"integer","minimum":0},"block":{"type":"integer","minimum":0},"timeblock":{"type":"integer","minimum":0},"studio":{"type":"integer","minimum":0}}},"Enrolment":{"type":"object","properties":{"slot":{"type":"object","oneOf":[{"$ref":"#/components/schemas/BlockSlot"},{"$ref":"#/components/schemas/PrivateSlot"},{"$ref":"#/components/schemas/CasualSlot"}]},"invoice":{"type":"integer"},"id":{"type":"integer"}}},"Student":{"type":"object","properties":{"id":{"type":"integer"},"lastName":{"type":"string"},"firstName":{"type":"string"},"contact":{"$ref":"#/components/schemas/ContactDetails"},"email":{"type":"string","nullable":true},"timezone":{"type":"string"},"associatedStudios":{"type":"array","items":{"allOf":[{"$ref":"#/components/schemas/StudentOrganization"},{"type":"object","properties":{"dob":{"type":"string","nullable":true}}}]}}}},"StudentOrganization":{"type":"object","properties":{"name":{"type":"string"},"dob":{"type":"string","nullable":true},"id":{"type":"integer"}},"required":["id","name","dob"]},"Age":{"type":"object","required":["equal","limit"],"properties":{"equal":{"type":"string","enum":["OVER","UNDER","EQUAL"],"example":"over"},"limit":{"type":"integer","example":18}}},"PaymentIntent":{"required":["expiry","downpayment","deposit","total","intentId"],"properties":{"expiry":{"type":"string","format":"datetime"},"deposit":{"type":"number","example":100.0},"downpayment":{"type":"number","example":50.0},"total":{"$ref":"#/components/schemas/Price"},"intentId":{"type":"string"}}},"Price":{"required":["inc","exc","taxRate","currency"],"properties":{"inc":{"type":"number","example":20},"exc":{"type":"number","example":18.18},"taxrate":{"type":"number","example":0.1}},"example":{"$ref":"#/components/examples/priceExample"}},"TierRule":{"type":"object","required":["price","tag","tagQuantity"],"properties":{"price":{"$ref":"#/components/schemas/Price"},"deposit":{"nullable":true,"allOf":[{"$ref":"#/components/schemas/Price"}]},"tag":{"type":"string","example":"pole"},"tagQuantity":{"type":"integer","example":2}}},"Slot":{"type":"object","required":["course","name","description","openPositions","type","location"],"properties":{"location":{"type":"string"},"course":{"type":"integer","example":100},"name":{"type":"string"},"description":{"type":"string"},"openPositions":{"type":"boolean"},"type":{"type":"string","enum":["BLOCK","PRIVATE","CASUAL"]},"pricing":{"oneOf":[{"$ref":"#/components/schemas/CasualPrice"},{"$ref":"#/components/schemas/BlockPrice"}]},"openTo":{"$ref":"#/components/schemas/SlotRestrictions"},"prerequisites":{"$ref":"#/components/schemas/SlotPrerequisites"}}},"BlockSlot":{"type":"object","allOf":[{"$ref":"#/components/schemas/Slot"}],"required":["block","term","classes","timeslots","begins","ends"],"properties":{"block":{"type":"integer","example":450},"term":{"type":"integer","example":6},"classes":{"type":"integer","example":8,"description":"The number of timeslots in this block"},"timeslots":{"type":"array","items":{"$ref":"#/components/schemas/Timeslot"}},"begins":{"type":"string","format":"date-time"},"ends":{"type":"string","format":"date-time"}}},"Timeslot":{"type":"object","required":["begins","ends","location","timeblockId","attendance"],"properties":{"begins":{"type":"string","format":"date-time"},"ends":{"type":"string","format":"date-time"},"timeblockId":{"type":"integer"},"location":{"type":"string"},"attendance":{"type":"string","nullable":true,"enum":["UNKNOWN","ATTENDING","NOT_ATTENDING"]}}},"PrivateSlot":{"type":"object","allOf":[{"$ref":"#/components/schemas/Slot"}],"required":["timeblock"],"properties":{"timeblock":{"$ref":"#/components/schemas/Timeslot"}}},"CasualSlot":{"type":"object","allOf":[{"$ref":"#/components/schemas/Slot"}],"required":["term","timeslot","week","block"],"properties":{"timeslot":{"$ref":"#/components/schemas/Timeslot"},"term":{"type":"integer","example":6},"week":{"type":"integer","example":3},"block":{"type":"integer","example":2}}},"CasualPrice":{"type":"object","properties":{"base":{"$ref":"#/components/schemas/Price"},"deposit":{"nullable":true,"allOf":[{"$ref":"#/components/schemas/Price"}]},"price":{"$ref":"#/components/schemas/Price"}},"example":{"base":{"$ref":"#/components/examples/priceExample"},"deposit":{"$ref":"#/components/examples/priceExample"},"price":{"$ref":"#/components/examples/priceExample"}}},"BlockPrice":{"type":"object","allOf":[{"$ref":"#/components/schemas/CasualPrice"}],"properties":{"prorated":{"$ref":"#/components/examples/priceExample"},"tiers":{"type":"array","items":{"$ref":"#/components/schemas/TierRule"}}}},"Course":{"type":"object","required":["id","name","tags"],"properties":{"id":{"type":"integer","example":3},"name":{"type":"string","example":"Beginners"},"description":{"type":"string","example":"Learn how to pole, learn how to pole, learn how to pole, with statepole!"},"enrolmentType":{"type":"string","enum":["BLOCK_AND_CASUAL","BLOCK","CASUAL"]},"upcomingSlots":{"type":"string","enum":["BLOCK_AND_CASUAL","BLOCK","CASUAL"]},"openTo":{"$ref":"#/components/schemas/SlotRestrictions"},"blockPrice":{"$ref":"#/components/schemas/BlockPrice"},"casualPrice":{"$ref":"#/components/schemas/CasualPrice"},"tags":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","example":"DanceClassTag"}}}}}},"SlotRestrictions":{"type":"object","required":["gender","age"],"properties":{"gender":{"type":"string","enum":["FEMALE","NONE","MALE"]},"age":{"$ref":"#/components/schemas/Age"}}},"SlotPrerequisites":{"type":"object","required":["difficulty"],"properties":{"difficulty":{"type":"integer","example":3}}},"ContactDetails":{"type":"object","required":["address","phone","countryCode"],"properties":{"phone":{"type":"string","example":"0400 111 111"},"address":{"type":"string","nullable":true,"example":"1 North Terrace, Adelaide, 5000"},"countryCode":{"type":"string","example":"(+61)"}}},"Person":{"type":"object","properties":{"allOf":{"$ref":"#/components/schemas/ContactDetails"},"name":{"type":"string"}}},"Studio":{"type":"object","required":["id","name","displayTaxes","words"],"properties":{"id":{"type":"integer","example":22},"name":{"type":"string","example":"Pole Monkeys"},"displayTaxes":{"type":"boolean","example":true},"logo":{"type":"string","example":"http://blobs.studiobuddy.com/images/PoleMonkeysLogo.png"},"contact":{"$ref":"#/components/schemas/ContactDetails"},"words":{"$ref":"#/components/schemas/StudioWords"},"color":{"type":"string","example":"0391ce"},"currency":{"type":"string","enum":["AUD","USD","GBP"],"example":"AUD"}}},"DraftInvoice":{"type":"object","properties":{"downpayment":{"$ref":"#/components/schemas/Downpayment"},"totals":{"$ref":"#/components/schemas/InvoiceTotals"},"items":{"type":"array","items":{"$ref":"#/components/schemas/LineItem"}}}},"Downpayment":{"type":"object","properties":{"amount":{"type":"number"},"due":{"type":"string","format":"datetime"}}},"InvoiceTotals":{"type":"object","properties":{"beforeDiscount":{"$ref":"#/components/schemas/Price"},"discounted":{"allOf":[{"$ref":"#/components/schemas/Price"},{"type":"object"}],"properties":{"discountName":{"type":"string","example":"Beginners Discount"}},"required":["discountName"]},"afterDiscount":{"$ref":"#/components/schemas/Price"},"deposit":{"type":"number","example":100.0},"paid":{"type":"number"},"outstanding":{"type":"number"}}},"Invoice":{"type":"object","properties":{"invoiceId":{"type":"number"},"title":{"type":"string","example":"Invoice 123"},"invoiceType":{"type":"string","enum":["SALES_ORDER"]},"status":{"type":"string","enum":["ACCEPTED_PENDING_PAYMENT"]},"created":{"type":"string","format":"date"},"downpayment":{"$ref":"#/components/schemas/Downpayment"},"shippedTo":{"$ref":"#/components/schemas/Person"},"billedTo":{"$ref":"#/components/schemas/Person"},"deleted":{"type":"boolean"},"voided":{"type":"boolean"},"autogen":{"type":"boolean"},"replaces":{"type":"number","example":3},"totals":{"$ref":"#/components/schemas/InvoiceTotals"},"payments":{"type":"array","items":{"type":"object","properties":{"amount":{"type":"number","example":10.0},"date":{"type":"string","format":"date"},"method":{"type":"string","enum":["ONLINE_STRIPE","MANUAL"]}}}},"items":{"type":"array","items":{"$ref":"#/components/schemas/LineItem"}}}},"LineItem":{"type":"object","properties":{"product":{"type":"object","properties":{"id":{"type":"integer","example":101},"variation":{"type":"integer","example":117628},"name":{"type":"string"}}},"code":{"type":"string","example":"STAFF-ENROL"},"name":{"type":"string","example":"Stretch and Flex"},"quantity":{"type":"integer","example":1},"unitPrice":{"$ref":"#/components/schemas/Price"},"linePrice":{"$ref":"#/components/schemas/Price"},"deposit":{"type":"number"},"appliedDiscountId":{"type":"integer","example":33138}}},"Term":{"type":"object","properties":{"id":{"type":"integer","example":100},"name":{"type":"string","example":"Term 1"},"begins":{"type":"string","format":"date","example":"2017-01-01"},"ends":{"type":"string","format":"date","example":"2017-02-01"}}},"Disclaimer":{"type":"object","required":["id","snapshotId","requires_signature","title","body"],"properties":{"id":{"type":"integer","example":1000},"snapshotId":{"type":"integer","example":13000},"requires_signature":{"type":"boolean","example":true},"title":{"type":"string","example":"Emergency Info Update Disclaimer"},"body":{"type":"string","example":"Please check this information is correct."}}},"DisclaimerAcknowledgement":{"type":"object","required":["id","snapshotId"],"properties":{"id":{"type":"integer","example":1000},"snapshotId":{"type":"integer","example":130000},"signature":{"type":"string","format":"byte"}}},"StudioWords":{"type":"object","required":["block","casual","private"],"properties":{"block":{"type":"string","example":"Block"},"casual":{"type":"string","example":"Casual/Drop In"},"private":{"type":"string","example":"Private"}}},"ErrorResponse":{"type":"object","properties":{"error":{"$ref":"#/components/schemas/ErrorPayload"}}},"ErrorPayload":{"type":"object","properties":{"type":{"type":"string","enum":["BAD_REQUEST","ENROLMENT_FAILURE","PERMISSION_DENIED"]},"code":{"type":"string","enum":["EF_100","EF_101","BR_100","BR_101","PD_100"],"description":"EF: Enrolment Failure codes. * EF_100: User already enrolled into one or more slots. * EF_101: One or more slots cannot be enrolled into.\n      For example:\n       - Slot is full\n       - Slot has already finished\nBR: Bad Request codes.  * BR_100: InvalidContentType * BR_101: Missing a required query parameter.  PD: Permission Denied codes. * PD_100: Student not allowed to perform the attempted action.\n"},"messages":{"type":"array","items":{"type":"string"}}}}},"examples":{"priceExample":{"value":{"inc":18.18,"exc":20,"taxrate":0.1}},"TierRuleExample":{"value":{"price":{"$ref":"#/components/examples/priceExample"},"deposit":{"$ref":"#/components/examples/priceExample"},"tag":"danceclass","tagQuantity":2}},"Model_PostClasses_Example":{"value":{"attending":1,"course":30,"term":2,"block":0,"timeblock":1500,"studio":11,"nonAttendanceReason":2}}}}}