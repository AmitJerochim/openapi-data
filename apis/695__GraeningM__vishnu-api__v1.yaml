openapi: 3.0.1
info:
  title: Vishnu API
  version: v1
paths:
  '/api/Accounting/Invoices/{accountNumber}':
    get:
      tags:
        - Accounting
      summary: Gets Invoices for Customer
      parameters:
        - name: accountNumber
          in: path
          description: Account Number
          required: true
          schema:
            type: string
        - name: useLegacy
          in: query
          description: >-
            If true will include records from prior to 2015. Defaults to false
            if not provided
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingInvoicesResponse'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingInvoicesResponse'
            text/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingInvoicesResponse'
  '/api/Accounting/Transactions/{accountNumber}':
    get:
      tags:
        - Accounting
      summary: Gets Invoices for Customer
      parameters:
        - name: accountNumber
          in: path
          description: Account Number
          required: true
          schema:
            type: string
        - name: useLegacy
          in: query
          description: >-
            If true will include records from prior to 2015. Defaults to false
            if not provided
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingTransactionResponse'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingTransactionResponse'
            text/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingTransactionResponse'
  '/api/ApplyCash/{id}':
    get:
      tags:
        - ApplyCash
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CustomerUnappliedCash'
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerUnappliedCash'
            text/json:
              schema:
                $ref: '#/components/schemas/CustomerUnappliedCash'
    post:
      tags:
        - ApplyCash
      summary: >-
        This will apply an open cash to any open invoices. Response object will
        return ar_unapplied_Cash_id, success status, and error message if
        applicable. Any invoices applied to will be updated in salesforce.
      parameters:
        - name: id
          in: path
          description: ''
          required: true
          schema:
            type: integer
            format: int32
      requestBody:
        description: ''
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
          text/json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
          application/*+json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
  '/api/ApplyCashByAccount/{id}':
    post:
      tags:
        - ApplyCashByAccount
      summary: >-
        This will apply an open cash to any open invoices. Response object will
        return ar_unapplied_Cash_id, success status, and error message if
        applicable. Any invoices applied to will be updated in salesforce.
      parameters:
        - name: id
          in: path
          description: ''
          required: true
          schema:
            type: integer
            format: int32
      requestBody:
        description: ''
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
          text/json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
          application/*+json:
            schema:
              $ref: '#/components/schemas/ApplyCash'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/ApplyCashResponse'
  /api/CancelCredit:
    post:
      tags:
        - CancelCredit
      summary: >-
        This method will check if an account has any invoices to create a cancel
        credit for. If any invoices are credited off will update salesforce
        invoice. Response Object will Return SuccessStatus, Error Message if
        applicable, and CreditId if applicable
      requestBody:
        description: ''
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelCredit'
          text/json:
            schema:
              $ref: '#/components/schemas/CancelCredit'
          application/*+json:
            schema:
              $ref: '#/components/schemas/CancelCredit'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CancelCreditResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/CancelCreditResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/CancelCreditResponse'
  /api/Credit:
    post:
      tags:
        - Credit
      summary: Creates a new credit within sedona.
      description: "This will create a credit within Sedona. Apply the credit according to the rules of the credit reason. \r\nAnd appropriately calculate and apply tax amounts when applicable. \r\nThe credit reason supplied will determine the Category Code, InvoiceDescriptionCode, CreditReasonCode, CreditItems, and AutoApply Flags as well as what invoices to apply to. Any invoices applied to will be updated into salesforce to reflect new amount due. Response object will return CreditId, Success Status, ErrorMessage, and Post tax amount."
      requestBody:
        description: ''
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Credit'
          text/json:
            schema:
              $ref: '#/components/schemas/Credit'
          application/*+json:
            schema:
              $ref: '#/components/schemas/Credit'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CreditResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/CreditResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/CreditResponse'
  /api/CycleChangeCredit:
    post:
      tags:
        - CycleChangeCredit
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CycleChangeCredit'
          text/json:
            schema:
              $ref: '#/components/schemas/CycleChangeCredit'
          application/*+json:
            schema:
              $ref: '#/components/schemas/CycleChangeCredit'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CycleChangeCreditResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/CycleChangeCreditResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/CycleChangeCreditResponse'
  /api/Payment:
    post:
      tags:
        - Payment
      summary: >-
        Adds a payment to Sedona. Optionally applies to invoices in order passed
        in.
      description: >-
        This method will be used to post payments to Sedona. It will add the
        payment into Sedona. If method is passed with Invoices, it will apply to
        the oldest outstanding invoice in that collection. If no invoices are
        passed or the amount exceeds net due of passed invoices, it will then
        seek out any remaining open invoice looking at oldest outstanding first.
        After successful post to Sedona, the API will then call out to
        salesforce to update the net due on any invoices that payment was
        applied to. Response object will return success status, error message if
        applicable, and sedonapaymentid

      requestBody:
        description: ''
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Payment'
          text/json:
            schema:
              $ref: '#/components/schemas/Payment'
          application/*+json:
            schema:
              $ref: '#/components/schemas/Payment'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
  '/api/Salesforce/UpsertInvoice/{invoiceId}':
    post:
      tags:
        - Salesforce
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/BaseResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
  '/api/Salesforce/UpsertInvoiceByInvoiceNumber/{invoiceNumber}':
    post:
      tags:
        - Salesforce
      parameters:
        - name: invoiceNumber
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/BaseResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
components:
  schemas:
    InvoiceApplyBy:
      type: object
      properties:
        transaction_Date:
          type: string
          description: Date of Transaction
          format: date-time
        docNumber:
          type: string
          description: Document Number
          nullable: true
        amount:
          type: number
          description: Amount Applied to Invoice
          format: double
        appliedAccountNumber:
          type: string
          description: Account Number transactions originates from
          nullable: true
        matchNumber:
          type: string
          description: internal use to match on
          nullable: true
        applyType:
          type: string
          description: 'Type of Transaction, Payment, Credit, Unapplied Cash'
          nullable: true
        checkNumber:
          type: string
          description: Check Number of transaction
          nullable: true
      additionalProperties: false
    AccountingInvoicesResponse:
      type: object
      properties:
        customerNumber:
          type: string
          nullable: true
        documentNumber:
          type: string
          description: Invoice Number
          nullable: true
        documentType:
          type: string
          description: Invoice Type
          nullable: true
        documentDescription:
          type: string
          description: Service Type
          nullable: true
        dueDate:
          type: string
          description: Due Date
          format: date-time
        documentDate:
          type: string
          description: Doc Date
          format: date-time
        originalDocumentAmount:
          type: number
          description: Amount
          format: double
        currentTRxAmount:
          type: number
          description: Net Due
          format: double
        draftDate:
          type: string
          description: Draft Date
          format: date-time
          nullable: true
        appliedBy:
          type: array
          items:
            $ref: '#/components/schemas/InvoiceApplyBy'
          description: Transactions Applied to Invoice
          nullable: true
        keyType:
          type: string
          description: Identifies what the KeyId is for
          nullable: true
        keyId:
          type: integer
          description: Sedona Primary key
          format: int32
      additionalProperties: false
    TransactionApplyTo:
      type: object
      properties:
        transactionDate:
          type: string
          description: Date of Transaction
          format: date-time
        documentNumber:
          type: string
          description: Document Number of applied to object
          nullable: true
        appliedAmount:
          type: number
          description: Amount Applied
          format: double
        appliedAccountNumber:
          type: string
          description: Account Number that document is for
          nullable: true
      additionalProperties: false
      description: What the transaction was applied to
    AccountingTransactionResponse:
      type: object
      properties:
        customerNumber:
          type: string
          description: Account Number
          nullable: true
        documentNumber:
          type: string
          description: Transaction Number
          nullable: true
        checkNumber:
          type: string
          description: 'Check #'
          nullable: true
        documentType:
          type: string
          description: PMT/Credit type
          nullable: true
        documentDescription:
          type: string
          description: ''
          nullable: true
        dueDate:
          type: string
          format: date-time
        documentDate:
          type: string
          description: Transaction Date
          format: date-time
        originalDocumentAmount:
          type: number
          description: Amount
          format: double
        currentTRxAmount:
          type: number
          description: Unapplied Amount
          format: double
        appliedTo:
          type: array
          items:
            $ref: '#/components/schemas/TransactionApplyTo'
          description: What the transaction applied to.
          nullable: true
      additionalProperties: false
    CustomerUnappliedCash:
      type: object
      properties:
        unappliedCashId:
          type: integer
          description: Sedona internal autonumber for the Unapplied Cash record
          format: int32
        depositCheckId:
          type: integer
          description: Foreign key from AR_Deposit_Check table
          format: int32
        customerId:
          type: integer
          description: Foreign key from AR_Customer table
          format: int32
        depositDate:
          type: string
          format: date-time
          nullable: true
        amount:
          type: number
          format: double
        usedAmount:
          type: number
          format: double
        branchCode:
          type: string
          nullable: true
        usedDate:
          type: string
          format: date-time
          nullable: true
      additionalProperties: false
    ApplyCash:
      required:
        - customerId
        - id
      type: object
      properties:
        id:
          type: integer
          description: AR_Unapplied_Cash_Id
          format: int32
        customerId:
          type: integer
          description: Sedona Customer Id
          format: int32
        invoices:
          type: array
          items:
            type: integer
            format: int32
          description: Array of Sedona Invoice Ids to apply invoice to
          nullable: true
        userCode:
          type: string
          description: >-
            the user making this change; defaults to VishnuAPI if not set
            explicitly
          nullable: true
      additionalProperties: false
    ApplyCashResponse:
      type: object
      properties:
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
    CancelCredit:
      required:
        - accountNumber
        - branchCode
        - cancelDate
        - customerBillId
        - customerId
        - customerSiteId
      type: object
      properties:
        accountNumber:
          type: string
          description: Account Number of account
          nullable: true
        cancelDate:
          type: string
          description: Date of Effective Cancel End
          format: date-time
        customerId:
          type: integer
          description: Foreign key from AR_Customer table
          format: int32
        customerSiteId:
          type: integer
          description: Foreign key from AR_Customer_Site table
          format: int32
        customerBillId:
          type: integer
          description: Foreign key from AR_Customer_Bill table
          format: int32
        userCode:
          type: string
          description: >-
            the user making this change; defaults to UserCode value from config
            file if not set explicitly
          nullable: true
        branchCode:
          type: string
          description: Branch from AR_Branch table
          nullable: true
      additionalProperties: false
    CancelCreditResponse:
      type: object
      properties:
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
    Credit:
      required:
        - accountNumber
        - amount
        - branchCode
        - creditDate
        - creditReason
        - customerBillId
        - customerId
        - customerSiteId
      type: object
      properties:
        accountNumber:
          type: string
          description: Account Number of account
          nullable: true
        customerId:
          type: integer
          description: Sedona Customer Id
          format: int32
        customerSiteId:
          type: integer
          description: Sedona Customer Site Id
          format: int32
        customerBillId:
          type: integer
          description: Sedona Customer
          format: int32
        creditReason:
          type: string
          description: From AR_Item table
          nullable: true
        creditDate:
          type: string
          description: Date of Credit
          format: date-time
        ignoreAutoApply:
          type: boolean
          description: Ignore auto apply logic
        invoices:
          type: array
          items:
            type: integer
            format: int32
          description: Array of Sedona invoice id to look to apply to first
          nullable: true
        userCode:
          type: string
          description: Creator of Credit
          nullable: true
        branchCode:
          type: string
          description: Branch from AR_Branch table
          nullable: true
        amount:
          type: number
          description: Pre-tax amount of credit
          format: double
      additionalProperties: false
      description: Credit Object
    CreditResponse:
      type: object
      properties:
        amount:
          type: number
          description: Post Tax Amount
          format: double
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
      description: Response for Credit
    CycleChangeCredit:
      required:
        - accountNumber
        - branchCode
        - customerBillId
        - customerId
        - customerSiteId
        - dateNextCycle
        - sedonaRecurringId
      type: object
      properties:
        accountNumber:
          type: string
          description: Account Number of Customer
          nullable: true
        sedonaRecurringId:
          type: integer
          description: Recurring Id of service being changed
          format: int32
        dateNextCycle:
          type: string
          description: Next Cycle Draft date of recurring
          format: date-time
        customerId:
          type: integer
          description: Sedona Customer Id of Customer
          format: int32
        customerSiteId:
          type: integer
          description: Sedona Customer Site Id
          format: int32
        customerBillId:
          type: integer
          description: Sedona Customer
          format: int32
        branchCode:
          type: string
          description: Branch Code of customer
          nullable: true
        userCode:
          type: string
          description: User Requesting change
          nullable: true
      additionalProperties: false
    CycleChangeCreditResponse:
      type: object
      properties:
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
    Payment:
      required:
        - accountNumber
        - amount
        - branchCode
        - paymentDate
        - paymentType
        - salesforceTransactionId
      type: object
      properties:
        accountNumber:
          type: string
          description: Account number of account
          nullable: true
        paymentDate:
          type: string
          description: Date of payment
          format: date-time
        paymentType:
          type: string
          description: Type of payment
          nullable: true
        amount:
          type: number
          description: Amount of payment
          format: double
        salesforceTransactionId:
          type: string
          description: Id of transaction from Salesforce
          nullable: true
        invoices:
          type: array
          items:
            type: integer
            format: int32
          description: Array of Sedona invoice ids to apply invoice to
          nullable: true
        ignoreApply:
          type: boolean
          description: >-
            If set to true, will send as unapplied cash even if there's open
            invoices
        userCode:
          type: string
          description: User who took payment
          nullable: true
        customerId:
          type: integer
          description: Sedona Customer Id
          format: int32
        branchCode:
          type: string
          description: Branch Code for account
          nullable: true
      additionalProperties: false
      description: Payment Object
    PaymentResponse:
      type: object
      properties:
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
      description: Response for Payment
    BaseResponse:
      type: object
      properties:
        id:
          type: string
          description: Id of Object
          nullable: true
        isSuccess:
          type: boolean
          description: Success/fail Flag
        errorMessage:
          type: string
          description: Error Message If Any
          nullable: true
      additionalProperties: false
      description: Base Response for API calls
  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
servers:
  - url: https://vishnuapi-dev.myalarmcenter.com/
    description: dev version of api
